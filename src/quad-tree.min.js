(function(d){var a=function(g,f){if((g.x+g.width)<=f.x){return false}else{if((f.x+f.width)<=g.x){return false}else{if((g.y+g.height)<=f.y){return false}else{if((f.y+f.height)<=g.y){return false}}}}return true};var c=function(g,f){return g.x>=f.x&&g.y>=f.y&&(g.x+g.width)<=(f.x+f.width)&&(g.y+g.height)<=(f.y+f.height)};var e=function(j,g,f,k,i){var h=this;h.bounds=j;g=parseInt(g);f=parseInt(f);k=parseInt(k);h.max_objects=isNaN(g)?10:g;h.max_levels=isNaN(f)?4:f;h.level=isNaN(k)?0:k;h.nodes=[];h.objects=[];h.object_groups=[];h.qtd=0;h.parent=i===undefined?null:i};e.ID=0;e.prototype.clear=function(){var f=this;f.objects=[];f.object_groups=[];f.qtd=0;var g;for(g=0;g<4;g++){if(f.nodes[g]!==undefined&&f.nodes[g].qtd>0){f.nodes[g].clear()}}};e.prototype.insert=function(h){var f=this;if(h._id===undefined){h._id=e.ID;e.ID++}if(h.groups===undefined){h.groups=["default"]}h.groups.forEach(function(i){if(f.object_groups[i]===undefined){f.object_groups[i]=[]}f.object_groups[i][h._id]=h});f.objects[h._id]=h;f.qtd++;if(h._full_inside===undefined){if(!c(h,f.bounds)||f.qtd<=f.max_objects){h._full_inside=f.parent===null?f:f.parent}}if(h._parents===undefined){h._parents=[]}if(h._parents[f.level]===undefined){h._parents[f.level]=[]}h._parents[f.level].push(f);if(f.qtd>f.max_objects&&f.level<f.max_levels){if(f.nodes.length===0){f.split()}if(f.qtd===f.max_objects+1){f.objects.forEach(function(k){for(var i=0;i<4;i++){if(a(k,f.nodes[i].bounds)){f.nodes[i].insert(k)}}})}else{for(var g=0;g<4;g++){if(a(h,f.nodes[g].bounds)){f.nodes[g].insert(h)}}}}};e.prototype.isLeaf=function(){var f=this;return f.qtd<=f.max_objects};e.prototype.split=function(){var i=this;var m=i.level+1;var g=i.bounds.x;var l=i.bounds.y;var k=i.bounds.width/2;var f=i.bounds.height/2;var h=g+k;var j=l+f;i.nodes[0]=new e({x:g,y:l,width:k,height:f},i.max_objects,i.max_levels,m,i);i.nodes[1]=new e({x:h,y:l,width:k,height:f},i.max_objects,i.max_levels,m,i);i.nodes[2]=new e({x:h,y:j,width:k,height:f},i.max_objects,i.max_levels,m,i);i.nodes[3]=new e({x:g,y:j,width:k,height:f},i.max_objects,i.max_levels,m,i)};e.prototype.remove=function(f){var q=this;var g=q.level;var p=f._parents.length;for(var m=g;m<p;m++){var n=f._parents[m];var o=n.length;for(var l=0;l<o;l++){delete n[l].objects[f._id];var r=f.groups.length;for(var h=0;h<r;h++){delete n[l].object_groups[f.groups[h]][f._id]}n[l].qtd--}f._parents[m]=[]}};e.remove=function(n){if(n!==undefined){if(n._parents!==undefined){var m=n._parents.length;for(var o=0;o<m;o++){var h=n._parents[o];var l=h.length;for(var g=0;g<l;g++){delete h[g].objects[n._id];var i=n.groups.length;for(var f=0;f<i;f++){delete h[g].object_groups[n.groups[f]][n._id]}h[g].qtd--}n._parents[o]=[]}}}};e.reInsert=function(g){var f=g._full_inside;while(f.parent!==null&&f.parent!==undefined){f=f.parent}f.remove(g);f.insert(g)};e.prototype.retrieve=function(h,i){var f=this;f.insert(h);var g=e.getCollisions(h,i);e.remove(h);return g};e.getCollisions=function(k,m){var n=k._parents.length-1;var j=[];if(n!==undefined){var f=k._parents[n];var h=f.length;var l=[];for(var g=0;g<h;g++){if(m===undefined){f[g].objects.forEach(function(i,o){if(o!==k._id&&b(i.groups,k.groups)&&l[i._id]===undefined&&a(i,k)){l[i._id]=true;j.push(i)}})}else{if(f[g].object_groups[m]!==undefined){f[g].object_groups[m].forEach(function(i,o){if(o!==k._id&&l[i._id]===undefined&&a(i,k)){l[i._id]=true;j.push(i)}})}}}}return j};function b(k,h){var g=k.length;var f=h.length;for(var m=0;m<g;m++){for(var l=0;l<f;l++){if(k[m]==h[l]){return true}}}return false}d.QuadTree=e})(window);