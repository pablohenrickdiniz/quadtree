(function(c){var a=function(f,e){if((f.x+f.width)<=e.x){return false}else{if((e.x+e.width)<=f.x){return false}else{if((f.y+f.height)<=e.y){return false}else{if((e.y+e.height)<=f.y){return false}}}}return true};var b=function(f,e){return f.x>=e.x&&f.y>=e.y&&(f.x+f.width)<=(e.x+e.width)&&(f.y+f.height)<=(e.y+e.height)};var d=function(i,f,e,j,h){var g=this;g.bounds=i;f=parseInt(f);e=parseInt(e);j=parseInt(j);g.max_objects=isNaN(f)?10:f;g.max_levels=isNaN(e)?4:e;g.level=isNaN(j)?0:j;g.nodes=[];g.objects=[];g.qtd=0;g.parent=h===undefined?null:h};d.ID=0;d.prototype.clear=function(){var e=this;e.objects=[];e.qtd=0;var f;for(f=0;f<4;f++){if(e.nodes[f]!==undefined&&e.nodes[f].qtd>0){e.nodes[f].clear()}}};d.prototype.insert=function(g){var e=this;if(g._id===undefined){g._id=d.ID;d.ID++}if(g._group===undefined){g._group=1}e.objects[g._id]=g;e.qtd++;if(g._full_inside===undefined){if(!b(g,e.bounds)||e.qtd<=e.max_objects){g._full_inside=e.parent===null?e:e.parent}}if(g._parents===undefined){g._parents=[]}if(g._parents[e.level]===undefined){g._parents[e.level]=[]}g._parents[e.level].push(e);if(e.qtd>e.max_objects&&e.level<e.max_levels){if(e.nodes.length===0){e.split()}if(e.qtd===e.max_objects+1){e.objects.forEach(function(i){for(var h=0;h<4;h++){if(a(i,e.nodes[h].bounds)){e.nodes[h].insert(i)}}})}else{for(var f=0;f<4;f++){if(a(g,e.nodes[f].bounds)){e.nodes[f].insert(g)}}}}};d.prototype.isLeaf=function(){var e=this;return e.qtd<=e.max_objects};d.prototype.split=function(){var h=this;var l=h.level+1;var f=h.bounds.x;var k=h.bounds.y;var j=h.bounds.width/2;var e=h.bounds.height/2;var g=f+j;var i=k+e;h.nodes[0]=new d({x:f,y:k,width:j,height:e},h.max_objects,h.max_levels,l,h);h.nodes[1]=new d({x:g,y:k,width:j,height:e},h.max_objects,h.max_levels,l,h);h.nodes[2]=new d({x:g,y:i,width:j,height:e},h.max_objects,h.max_levels,l,h);h.nodes[3]=new d({x:f,y:i,width:j,height:e},h.max_objects,h.max_levels,l,h)};d.prototype.remove=function(m){var e=this;var n=e.level;var l=m._parents.length;for(var h=n;h<l;h++){var g=m._parents[h];var k=g.length;for(var f=0;f<k;f++){delete g[f].objects[m._id];g[f].qtd--}m._parents[h]=[]}};d.remove=function(i){if(i!==undefined){if(i._parents!==undefined){var h=i._parents.length;for(var k=0;k<h;k++){var f=i._parents[k];var g=f.length;for(var e=0;e<g;e++){delete f[e].objects[i._id];f[e].qtd--}i._parents[k]=[]}}}};d.reInsert=function(f){var e=f._full_inside;while(e.parent!==null&&e.parent!==undefined){e=e.parent}e.remove(f);e.insert(f)};d.getCollisions=function(j){var l=j._parents.length-1;var h=[];if(l!==undefined){var e=j._parents[l];var g=e.length;var k=[];for(var f=0;f<g;f++){e[f].objects.forEach(function(i,m){if(m!==j._id&&i._group===j._group){if(k[i._id]===undefined){if(a(i,j)){k[i._id]=true;h.push(i)}}}})}}return h};c.QuadTree=d})(window);